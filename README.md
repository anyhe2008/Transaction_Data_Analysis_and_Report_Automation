# Transaction_Data_Analysis_and_Report_Automation

对某品牌天猫旗舰店的110万条订单数据进行分析，主要涉及数据清洗、订单规律探索、复购分析、关联分析、购买路径、用户画像6个模块，并且实现了分析报表的自动输出。

## 1 数据清洗
- 商品识别：这是数据清洗的主要难点。商品标题时常会发生变动，但订单数据中并不提供有商品ID，这给商品的识别带来困难。我们先对商品标题进行清洗，再将其与历史爬虫数据进行匹配，最终使商品的识别率达到99.6%。
- 提取特征：从商品标题里提取促销信息；从收货地址里提取省/市/区等信息；标记这是该用户的第几单；区分首单和复购订单；计算订单涉及的单品数、品类数等
- 补充信息：利用其它数据源，标记CRM人群、促销和直播、城市级别等信息

## 2 订单规律探索
- 在时间维度上，分析店铺的月度销售情况，发现2020年3月疫情拉动了大盘暴涨；分析店铺的日度销售情况，发现促销日通常对应订单平均价值和复购率的低估；分析消费者的周内下单情况，发现消费者习惯周中下单、周末使用产品。
- 在会员维度上，发现店铺会员的订单平均价值、复购率都显著高于非会员，说明店铺需加强CRM运营。
- 在下单次数上，发现90%的消费者只购买一次，但随着购买次数的增加，订单平均价值会增大。
- 设计促销活动爆发系数计算算法，帮助商家衡量各促销活动的销售情况。

## 3 复购分析
计算各品类和单品的复购周期、复购率等指标，用于用户的定期触达

## 4 关联分析
使用关联分析模型，定位关联度高的品类和单品，用于捆绑销售和推荐商品设置，并向老客推荐其可能感兴趣的商品

## 5 用户购买路径绘制
使用多叉树的层次遍历算法和剪枝策略，利用Graphviz绘制用户的购买路径。
- 在品类维度，发现店铺爆品的消费者购买路径单一，而次热销的品类用户转化路径十分丰富
- 在促销维度，发现消费者的购买行为具有路径依赖性，即在平日下单的消费者更倾向于在平日复购，在大促日下单的消费者则更倾向于在大促日复购

## 6 用户画像
- 使用RFM模型，对用户进行分层并贴标签，帮助商家进行差异化的用户管理
- 对地域的消费力和品类偏好进行分析，发现江苏、广东、浙江、上海、山东、北京购买力最考前，山东省对番茄酱的购买率最高，上海、北京对锅物的购买率最高

## 报表自动化
对以上代码进行整合，实现新订单数据的自动处理，并用xlsxwriter实现分析报表的自动输出
